
Read problem statements in Hindi, Bengali, Mandarin Chinese, Russian, and Vietnamese as well.
Chef has a tree with N nodes (numbered 1 through N) and a non-negative integer x. The nodes of the tree have non-negative integer weights; let's denote the weight of node i by ai.
Next, let's define the XOR value of a tree as the bitwise XOR of weights of all its nodes.
Chef wants to remove zero or more edges from his tree in such a way that each individual tree in the forest formed by removing these edges has XOR value x. Help him compute the number of ways to remove a set of edges such that this condition is satisfied. Since the answer may be large, compute it modulo 109+7.
Input

The first line of the input contains two space-separated integers N and x.
The second line contains N space-separated integers a1,a2,…,aN.
Each of the following N−1 lines contains two space-separated integers u and v denoting an edge between nodes u and v in Chef's tree.

Output
Print a single line containing one integer ― the number of ways to remove edges, modulo 109+7.
Constraints

1≤N≤105
0≤x≤109
0≤ai≤109 for each valid i
1≤u,v≤N

Subtasks
Subtask #1 (10 points): N≤100
Subtask #2 (20 points): N≤5,000
Subtask #3 (70 points): original constraints

                        Sample Input 1
                        





7 1
1 0 1 0 1 0 1 
1 2
1 3
2 4
2 5
3 6
3 7



                        Sample Output 1
                        





5


Explanation
There are five valid ways to remove edges, splitting the tree into subtrees on nodes:

[1, 2, 3, 4, 5, 6] and [7] by removing the edge (3-7)
[1, 2, 3, 4, 6, 7] and [5] by removing the edge (2-5)
[2, 4, 5] and [1, 3, 6, 7] by removing the edge (1-2)
[2, 4, 5], [1], [3,6] and [7] by removing edges (1-2), (1-3) and (3-7)
[1, 2, 4], [5], [3,6] and [7] by removing edges (2-5), (1-3) and (3-7)




Author:
4★stevens


Editorial:
https://discuss.codechef.com/problems/XDCOMP


Tags:

               
                 DP on Trees
                 
                     
                     Advanced Algorithms, Advanced DP
                 
               
             
             



                        Difficulty Rating:
                    

2279


Date Added:
24-01-2019


Time Limit:
1 secs


Source Limit:
50000 Bytes


Languages:
PYTH 3.6, JAVA, C, CPP14, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, kotlin, PERL, SCALA, LUA, BASH, JS, rust, LISP sbcl, PAS gpc, BF, CLOJ, D, CAML, swift, FORT, ASM, FS, WSPC, LISP clisp, SCM guile, PERL6, ERL, CLPS, PRLG, ICK, NICE, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM





Submit

