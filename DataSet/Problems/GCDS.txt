
Read problems statements Mandarin , Bengali , Hindi , Russian and Vietnamese as well.
Pantelija was given a sequence of positive integers a1,a2,…,aN. Let's define the gcd value of this sequence as the number of its non-empty contiguous subsequences with greatest common divisor strictly greater than 1. The greatest common divisor of any contiguous subsequence al,al+1,…,ar (1≤l≤r≤N) is the greatest positive integer which divides each element of this subsequence.
Pantelija wants to maximise the gcd value of this sequence. In order to do that, he may choose a valid index i, an integer b (1≤b≤5⋅105, since he does not like large numbers) and change the element ai to b. What is the maximum possible gcd value he can obtain?
Input

The first line of the input contains a single integer N.
The second line contains N space-separated integers a1,a2,…,aN.

Output
Print a single line containing one integer ― the largest possible gcd value.
Constraints

1≤N≤5⋅104
1≤ai≤5⋅105 for each valid i

Subtasks
Subtask #1 (15 points):

1≤N≤100
1≤ai≤100 for each valid i

Subtask #2 (35 points):

1≤N≤5⋅104
1≤ai≤500 for each valid i

Subtask #3 (50 points): original constraints

                        Sample Input 1
                        





5
4 5 10 3 7



                        Sample Output 1
                        





9





Author:
6★allllekssssa


Editorial:
https://discuss.codechef.com/problems/GCDS


Tags:

               
                 Number Theory, Branch and Bound, Two pointers, Prefix Sum
                 
                     
                     Mathematics, Algorithms, Complete Search, Simple Algos
                 
               
             
             



                        Difficulty Rating:
                    

2945


Date Added:
29-03-2019


Time Limit:
1.2 secs


Source Limit:
50000 Bytes


Languages:
PYTH 3.6, JAVA, C, CPP14, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, kotlin, PERL, SCALA, LUA, BASH, JS, rust, LISP sbcl, PAS gpc, BF, CLOJ, R, D, CAML, swift, FORT, ASM, FS, WSPC, LISP clisp, SCM guile, PERL6, ERL, CLPS, PRLG, ICK, NICE, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM





Submit

